# PPT自动化工具 v4.1.2

一个强大而易用的PPT自动化工具，支持批量插入图片、自动填充文本，并提供灵活的布局模式管理。

## ✨ 核心特性

### 🖼️ 图片插入功能
- **多种布局模式**: 支持自定义和保存多种布局模式
- **精确定位**: 厘米级精确控制图片位置和尺寸
- **批量处理**: 一键填充所有图片到指定位置
- **模板系统**: 支持从PPT模板导入布局和背景

### 📝 文本插入功能（v4.1.2新增）
- **关键词搜索**: 根据文件名关键词自动匹配数据文件
- **智能读取**: 支持多种编码格式（UTF-8、GBK、GB2312等）
- **灵活提取**: 指定行列提取数据，支持多列组合
- **自动格式化**: 数字自动格式化为三位有效数字
- **字体定制**: 支持LiciumFont 2022等专业字体

### 🎨 界面特性
- **现代化UI**: 圆角按钮、清爽配色、直观布局
- **实时预览**: 16:9布局预览窗口，所见即所得
- **拖拽友好**: 支持滚动操作，适应大量图片
- **状态反馈**: 实时显示操作进度和结果

## 📦 安装说明

### 方法一：直接运行（推荐）

如果你已有可执行文件 `PPT自动化工具.exe`：
1. 双击运行，无需安装任何依赖
2. 适用于Windows系统

### 方法二：从源码运行

1. **安装Python**（需要Python 3.7+）

2. **安装依赖包**
```bash
pip install -r requirements.txt
```

或手动安装：
```bash
pip install python-pptx>=0.6.21
pip install Pillow>=9.0.0
```

3. **运行程序**
```bash
python ppt_image_inserter_gui.py
```

或在Windows下双击运行 `启动源码.bat`

## 🚀 快速开始

### 基本工作流程

1. **选择布局模式**
   - 从下拉菜单选择预设布局模式
   - 或选择"自定义"手动配置

2. **设置模板文件**（可选）
   - 点击"设置模板文件"选择PPT模板
   - 模板中的背景和样式会被应用

3. **选择工作目录**
   - 点击"选择工作目录"
   - 选择包含图片和数据文件的文件夹

4. **配置图片和文本**
   - 使用"填充所有图片"自动填充图片
   - 使用"填充所有文本"自动填充文本
   - 或手动添加和配置每个元素

5. **生成PPT**
   - 点击"确认插图"按钮
   - 程序自动生成PPT并保存到工作目录

## 📚 使用教程

### 图片插入详解

#### 添加图片的三种方式

1. **批量填充**（推荐）
   - 点击"填充所有图片"
   - 自动扫描工作目录下所有图片
   - 按文件名排序填充到布局位置

2. **手动添加**
   - 点击"+ 添加单个图片"
   - 选择具体的图片文件
   - 适合精确控制

3. **从布局模式加载**
   - 选择已保存的布局模式
   - 图片位置自动加载
   - 只需填充图片文件名

#### 图片参数说明

- **左(cm)**: 图片左边距，从幻灯片左边缘算起
- **上(cm)**: 图片上边距，从幻灯片上边缘算起
- **宽(cm)**: 图片宽度（留空则按高度等比缩放）
- **高(cm)**: 图片高度（留空则按宽度等比缩放）

> 💡 提示：标准PPT尺寸为 66.69cm × 37.27cm（16:9比例）

### 文本插入详解

#### 文本参数配置

- **关键词**: 用于搜索匹配的数据文件名
- **行**: 要读取的文件行号（从1开始）
- **列**: 要读取的列号，多列用逗号分隔（如：1,3,5）
- **左(cm)/上(cm)**: 文本框位置

#### 文件匹配规则

1. **有关键词**：搜索文件名包含该关键词的文件
2. **无关键词**：自动搜索工作目录下的文本文件
   - 支持扩展名：`.txt`, `.csv`, `.log`, `.dat`, `.json`, `.xml`
   - 支持特殊格式：`.o数字`（如 `.o2343908`）

#### 数据格式化

程序会自动格式化数字数据：
- 保留三位有效数字
- 小数自动精简（如：1.00 显示为 1）
- 大数使用科学计数法
- 多列数据用 `/` 分隔

### 布局模式管理

#### 保存自定义布局

1. 配置好所有图片和文本的位置
2. 点击"保存当前布局"
3. 输入布局模式名称
4. 选择使用模板的哪一页（如已设置模板）

#### 删除布局模式

1. 点击"删除布局模式"
2. 从列表中选择要删除的模式
3. 确认删除

> ⚠️ 注意："自定义"模式不能被删除

## 🎯 使用场景

### 场景1：科研论文配图
```
布局: 四宫格或六宫格
图片: 实验结果截图
文本: 数据标注（从日志文件读取）
```

### 场景2：项目汇报PPT
```
布局: 左侧主图+右侧三图
图片: 项目进展照片
文本: 关键指标（从数据文件读取）
```

### 场景3：教学课件
```
布局: 单图居中或上下双图
图片: 示意图和实例
文本: 公式和说明（从文本文件读取）
```

## 🔧 高级功能

### 模板系统

程序支持使用PPT模板，模板中可以包含：
- 背景图片和颜色
- 公司Logo
- 页眉页脚
- 文本框和形状

> 💡 提示：程序会复制模板页面，然后在新页面上添加图片和文本

### 配置文件

程序配置保存在：
```
C:\Users\[用户名]\.ppt_image_inserter\custom_modes.json
```

包含：
- 所有已保存的布局模式
- 每个模式的图片布局
- 每个模式的文本布局
- 关联的模板文件路径

### 多编码支持

文本读取支持以下编码：
- UTF-8
- GBK / GB2312
- UTF-16
- Latin-1

程序会自动尝试所有编码直到成功读取。

## 📐 坐标系统

PPT坐标系统说明：
```
(0,0) ←─────────────→
  │                  ↓
  │    [图片/文本框]
  │
  ↓
```

- **原点**: 左上角 (0, 0)
- **X轴**: 从左到右（left参数）
- **Y轴**: 从上到下（top参数）
- **单位**: 厘米（cm）

## ⚙️ 配置说明

### 图片文件名格式

推荐命名格式：
```
a.jpg, b.png, c.bmp     # 字母序列
1.jpg, 2.png, 3.bmp     # 数字序列
fig1.jpg, fig2.png      # 前缀+数字
```

### 数据文件格式

支持的文本文件格式：
```
# 空格或制表符分隔
数据1 数据2 数据3
1.234 5.678 9.012

# CSV格式
数据1,数据2,数据3
1.234,5.678,9.012
```

## 🐛 常见问题

### Q: 图片找不到文件？
A: 确保图片文件和数据文件都在选择的工作目录下，检查文件名是否匹配。

### Q: 文本没有正确提取？
A: 检查行号和列号是否正确，文件是否为文本格式。可以在记事本中打开文件验证。

### Q: 生成的PPT位置不对？
A: 在布局预览窗口中确认位置，注意单位是厘米，标准PPT宽66.69cm，高37.27cm。

### Q: 数字格式不符合要求？
A: 程序自动格式化为三位有效数字。如需特殊格式，可以在生成后在PPT中手动调整。

### Q: 如何使用多列数据？
A: 在"列"输入框中输入多个列号，用逗号分隔，如：`1,3,5`。结果会用 `/` 连接。

### Q: 支持哪些图片格式？
A: 支持 JPG、JPEG、PNG、BMP、GIF 等常见格式。

### Q: 可以同时处理多页PPT吗？
A: 当前版本每次生成一页PPT。如需多页，可以运行多次或使用不同的布局模式。

## 📝 版本历史

### v4.1.2 (2026-02)
- ✨ 文本关键词检索功能
- ✨ 支持从不同文件读取文本
- 🎨 优化文本条目界面（浅灰边框）
- 🔧 改进文件搜索逻辑

### v4.1.1 (2026-01)
- ✨ 文本框形式插入文本
- ✨ 一键插字功能
- ✨ 字体和字间距调整
- 🔧 所有文本从日志文件统一读取

### v3.10.0 (2026-01)
- 🎨 滚动条优化
- ✨ 清空按钮和未分配选项
- 🐛 修复对话框遮挡问题
- 🎨 界面布局优化

### v3.9.0 (2026-01)
- 🎨 扩展预览色彩包（10种颜色）
- 🎨 预览窗口严格16:9比例
- 🔧 撤回自动缩放功能

[查看完整更新日志](CHANGELOG_.md)

## 🔨 打包说明

### 打包成可执行文件

使用提供的批处理文件：
```bash
build_exe.bat
```

或手动打包：
```bash
pyinstaller --onefile --windowed --icon=icon.ico --name="PPT自动化工具" ppt_image_inserter_gui.py
```

生成的exe文件在 `dist` 文件夹中。

### 自定义图标

将 `icon.ico` 替换为自己的图标文件即可。

## 📄 许可证

此工具可自由使用和修改。

## 🤝 贡献

欢迎提出问题和建议！

## 📧 技术支持

如有问题或建议，欢迎反馈。

---

**PPT自动化工具** - 让PPT制作更高效 🚀
